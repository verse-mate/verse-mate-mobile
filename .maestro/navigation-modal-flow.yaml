---
appId: org.versemate.app
name: Navigation Modal Flow
description: Tests book and chapter selection through navigation modal
tags:
  - critical
  - navigation
  - modal

---

# Navigation Modal E2E Test
#
# This flow tests the navigation modal functionality:
# - Open navigation modal
# - Select book from list
# - Select chapter from grid
# - Navigate to selected chapter
#
# User Journey:
# 1. Launch app to Genesis 1
# 2. Open navigation modal
# 3. Verify modal opens
# 4. Select a New Testament book (Matthew)
# 5. Select chapter 5 from grid
# 6. Verify Matthew 5 loads

- launchApp:
    appId: org.versemate.app

# For development builds: dismiss dev menu if shown
- tapOn:
    text: "http://localhost:8081"
    optional: true

- tapOn:
    text: "Continue"
    optional: true

- tapOn:
    point: "50%,15%"
    optional: true

# Wait for app to load
- waitForAnimationToEnd

# Verify chapter selector button is visible (app loaded)
- assertVisible:
    id: "chapter-selector-button"

# Open navigation modal
- tapOn:
    id: "chapter-selector-button"

# Verify modal opened
- assertVisible:
    id: "bible-navigation-modal"

# Switch to New Testament tab (Matthew is in NT)
- tapOn:
    id: "tab-new-testament"

# Wait for tab switch animation
- waitForAnimationToEnd

# Select Matthew from book list (lowercase hyphenated per testID convention)
- tapOn:
    id: "book-item-matthew"

# Wait for chapter grid to appear
- waitForAnimationToEnd

# Select chapter 5
- tapOn:
    id: "chapter-5"

# Modal should close and navigate to Matthew 5
- waitForAnimationToEnd

# Verify modal closed
- assertNotVisible:
    id: "bible-navigation-modal"

# Verify we're on the new chapter (chapter selector button still visible)
- assertVisible:
    id: "chapter-selector-button"

# Open modal again to test selecting a different book
- tapOn:
    id: "chapter-selector-button"

# Verify modal opened
- assertVisible:
    id: "bible-navigation-modal"

# Switch to Old Testament tab (Genesis is in OT)
- tapOn:
    id: "tab-old-testament"

# Wait for tab switch animation
- waitForAnimationToEnd

# Select Genesis from Old Testament
- tapOn:
    id: "book-item-genesis"

# Wait for chapter grid
- waitForAnimationToEnd

# Select chapter 1 (back to start)
- tapOn:
    id: "chapter-1"

# Modal should close
- waitForAnimationToEnd

# Verify modal closed
- assertNotVisible:
    id: "bible-navigation-modal"

# Verify chapter selector button visible (navigation complete)
- assertVisible:
    id: "chapter-selector-button"

# Note: Swipe-to-dismiss test removed as Maestro's swipe gesture doesn't reliably
# trigger iOS sheet dismissal. Manual testing confirms swipe dismissal works.
